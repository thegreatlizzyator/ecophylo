---
title: "run_utils"
author: "Maxime Jaunatre"
date: "18/02/2021"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(reticulate)
```

Small bit of code to help debug. Objective is to regroup here all examples of the python code.

# toPhylo.py

Work with python tree.

```{python}
from ete3 import Tree
tree = Tree()
# We create a random tree topology
tree.populate(5)
# or build from a newick style
tree = Tree('((A:1,(B:1,C:1)1:1)1:2,(D:1,E:1)1:5);')

print(tree)
node = tree.get_tree_root()
node = tree.children[0]
print(node)
node.dist * 1
node.dist * 0.5
node.dist * 0
```


init parameters of 

```{python}

node = tree.get_tree_root()

mu = 0
seed = 42

lambd = node.dist * mu

```



@>>> print(tree)

      /-1
   /-|
  |  |   /-8
  |   \-|
  |     |   /-0
--|      \-|
  |         \-2
  |
  |   /-7
  |  |
   \-|      /-6
     |   /-|
     |  |   \-9
      \-|
        |   /-5
         \-|
           |   /-3
            \-|
               \-4
@>>> tree.write()
'((1:65314.4,(8:15354.3,(0:2085.64,2:2085.64)1:13268.6)1:49960.1)1:361157,(7:69185.4,((6:9732.48,9:9732.48)1:14540.2,(5:16152.1,(3:3211.46,4:3211.46)1:12940.7)1:8120.56)1:44912.7)1:357286);'
@>>> import ecophylo as eco
@>>> phylo = eco.toPhylo(tree, 0.03, seed = 42)
@>>> print(phylo)

      /-1
   /-|
  |  |   /-8
  |   \-|
--|      \-0
  |
  |   /-7
  |  |
   \-|      /-5
     |   /-|
      \-|   \-3
        |
         \-6
@>>> phylo.write()
'((1:65314.4,(8:15354.3,0:15354.3)1:49960.1)1:361157,(7:69185.4,((5:16152.1,3:16152.1)1:8120.56,6:24272.7)1:44912.7)1:357286);'
@>>> 

```{python}
import ecophylo as eco
from ete3 import Tree
tree = Tree('((A:4,(B:4,C:3)1:4)1:5, Err: 1, (D:1,E:1)1:1);')
print(tree)
phylo = eco.toPhylo(tree, 0.5, seed = 42)

mano = Tree('(((A:5,(B:3, C:3))1:2,(D:2, E:2)1:5)1:2, Err:2, (F:3, G:3)1:6);')
print(mano)

mano.children[0]

phylo = eco.toPhylo(mano, 0.5, seed = 42)
print(phylo)
eco.getAbund(phylo, 7)

print(eco.toPhylo(mano, 0.5, seed = 42))

# mu = 0.5
# 
# # import numpy as np
# # np.random.seed(42)
# # for i in range(1,15): 
# #   print(i, end = ' ~ ')
# #   print(i*mu, end = ' ~ ')
# #   print(np.random.poisson(i*mu) >= 1)
# # print('done')
# 
# import msprime
# 
# treeseq = msprime.simulate(sample_size= 10, Ne = 1e5,
#                            random_seed= 42, demographic_events = None)
# tree = treeseq.first()
# node_labels = {u: str(u) for u in tree.nodes() if tree.is_sample(u)}
# tree = Tree(tree.newick(node_labels = node_labels))
# print(tree)
# phylo = eco.toPhylo(tree, 0.03, seed = 42)
# print(phylo)
# 
# t = eco.simulate(10, 1e5, 0.03, seed = 42)
# print(t)
```

